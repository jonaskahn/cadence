# Cadence v2.0 - Environment Configuration
# Copy this file to .env and configure with your values
#
# NOTE: This file contains INFRASTRUCTURE settings only (immutable, set at deploy time).
# All operational defaults (LLM, caching, rate limits, pool sizes, streaming, etc.)
# live in the global_settings database table and are managed via the admin API.
# Changes to global_settings are broadcast to all nodes via RabbitMQ automatically.

#==============================================================================
# API SERVER
#==============================================================================

# Server host and port
CADENCE_API_HOST=0.0.0.0
CADENCE_API_PORT=8000

# Environment: development, staging, production
CADENCE_ENVIRONMENT=development

# Debug mode (disable in production)
CADENCE_DEBUG=true

#==============================================================================
# SECURITY
#==============================================================================

# Secret key for JWT signing (generate with: openssl rand -base64 32)
CADENCE_SECRET_KEY=your-secret-key-change-me-in-production

# JWT algorithm (HS256 for symmetric, RS256 for asymmetric)
CADENCE_JWT_ALGORITHM=HS256

# Token expiration (minutes)
CADENCE_ACCESS_TOKEN_EXPIRE_MINUTES=60

# Third-party JWT support (for external authentication)
CADENCE_THIRD_PARTY_JWT_SECRET_KEY=
CADENCE_THIRD_PARTY_JWT_ALGORITHM=RS256

# API protection (require authentication for all endpoints)
CADENCE_API_ENABLED_PROTECT=true

#==============================================================================
# DATABASE - POSTGRESQL
#==============================================================================

# PostgreSQL connection URL
# Format: postgresql+asyncpg://user:password@host:port/database
CADENCE_POSTGRES_URL=postgresql+asyncpg://cadence:cadence_dev_password@localhost:5432/cadence_dev

# Connection pool settings (optional)
CADENCE_POSTGRES_POOL_SIZE=20
CADENCE_POSTGRES_MAX_OVERFLOW=10
CADENCE_POSTGRES_POOL_TIMEOUT=30

#==============================================================================
# DATABASE - MONGODB
#==============================================================================

# MongoDB connection URL
# Format: mongodb://user:password@host:port/
CADENCE_MONGO_URL=mongodb://cadence:cadence_dev_password@localhost:27017/

# MongoDB connection options (optional)
CADENCE_MONGO_MAX_POOL_SIZE=100
CADENCE_MONGO_MIN_POOL_SIZE=10
CADENCE_MONGO_TIMEOUT_MS=5000

#==============================================================================
# DATABASE - REDIS
#==============================================================================

# Redis connection URL
# Format: redis://[:password@]host:port/db
CADENCE_REDIS_URL=redis://:cadence_dev_password@localhost:6379/0

# Redis database IDs
CADENCE_REDIS_DEFAULT_DB=0
CADENCE_REDIS_RATELIMIT_DB=1

# Redis connection options (optional)
CADENCE_REDIS_MAX_CONNECTIONS=50
CADENCE_REDIS_SOCKET_TIMEOUT=5
CADENCE_REDIS_SOCKET_CONNECT_TIMEOUT=5

#==============================================================================
# STORAGE & PLUGINS
#==============================================================================

# Root storage directory
CADENCE_STORAGE_ROOT=/var/cadence

# System plugins directory (available to all tenants)
CADENCE_SYSTEM_PLUGINS_DIR=/var/cadence/system_plugins

# Tenant plugins root (tenant-specific plugins)
CADENCE_TENANT_PLUGINS_ROOT=/var/cadence/tenant_plugins

# Enable directory-based plugin discovery
CADENCE_ENABLE_DIRECTORY_PLUGINS=true

# Plugin cache TTL (seconds)
CADENCE_PLUGIN_CACHE_TTL=3600

#==============================================================================
# MESSAGING (RabbitMQ)
#==============================================================================

# RabbitMQ connection URL (for orchestrator event bus and settings broadcast)
CADENCE_RABBITMQ_URL=amqp://cadence:cadence_dev_password@localhost:5672/

# Redis pub/sub channel for config changes
CADENCE_PUBSUB_CONFIG_CHANNEL=cadence:config_changes

# Enable pub/sub for cluster coordination
CADENCE_ENABLE_PUBSUB=true

#==============================================================================
# LOGGING
#==============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
CADENCE_LOG_LEVEL=INFO

# Log format: json, text
CADENCE_LOG_FORMAT=json

# Log file path (leave empty for stdout only)
CADENCE_LOG_FILE=

# Enable access logs
CADENCE_ENABLE_ACCESS_LOG=true

# Enable query logging (PostgreSQL slow queries)
CADENCE_ENABLE_QUERY_LOG=false
CADENCE_SLOW_QUERY_THRESHOLD_MS=1000

#==============================================================================
# CORS (Cross-Origin Resource Sharing)
#==============================================================================

# Allowed origins (comma-separated, or * for all)
CADENCE_CORS_ORIGINS=http://localhost:3000,http://localhost:8080

# Allow credentials
CADENCE_CORS_ALLOW_CREDENTIALS=true

# Allowed methods
CADENCE_CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS

# Allowed headers
CADENCE_CORS_ALLOW_HEADERS=*

#==============================================================================
# HEALTH & MONITORING
#==============================================================================

# Health check timeout (seconds)
CADENCE_HEALTH_CHECK_TIMEOUT=10

# Enable metrics collection
CADENCE_ENABLE_METRICS=true

# Metrics port (Prometheus format)
CADENCE_METRICS_PORT=9090

# Enable OpenTelemetry tracing
CADENCE_ENABLE_TRACING=false

# OTLP endpoint
CADENCE_OTLP_ENDPOINT=http://localhost:4317

#==============================================================================
# DEVELOPMENT & TESTING
#==============================================================================

# Enable development mode (auto-reload, detailed errors)
CADENCE_DEV_MODE=true

# Enable API documentation (Swagger UI)
CADENCE_ENABLE_API_DOCS=true

# API docs URL path
CADENCE_API_DOCS_URL=/docs

#==============================================================================
# ADVANCED SETTINGS
#==============================================================================

# Worker threads for async operations
CADENCE_WORKER_THREADS=4

# Max request size (MB)
CADENCE_MAX_REQUEST_SIZE=10

# Request timeout (seconds)
CADENCE_REQUEST_TIMEOUT=60

# Enable request compression
CADENCE_ENABLE_COMPRESSION=true

# Compression minimum size (bytes)
CADENCE_COMPRESSION_MIN_SIZE=1024

# Enable request/response validation
CADENCE_ENABLE_VALIDATION=true

# Timezone for scheduled tasks
CADENCE_TIMEZONE=UTC

#==============================================================================
# EXTERNAL SERVICES (Optional)
#==============================================================================

# Sentry DSN (error tracking)
CADENCE_SENTRY_DSN=

# Sentry environment
CADENCE_SENTRY_ENVIRONMENT=development

# Datadog API key (monitoring)
CADENCE_DATADOG_API_KEY=

# Datadog app key
CADENCE_DATADOG_APP_KEY=

# Slack webhook (notifications)
CADENCE_SLACK_WEBHOOK_URL=

# Email SMTP settings (notifications)
CADENCE_SMTP_HOST=
CADENCE_SMTP_PORT=587
CADENCE_SMTP_USER=
CADENCE_SMTP_PASSWORD=
CADENCE_SMTP_FROM=noreply@cadence.local

#==============================================================================
# NOTES
#==============================================================================

# 1. Always use strong passwords in production
# 2. Generate secret keys with: openssl rand -base64 32
# 3. Use SSL/TLS for all database connections in production
# 4. Set CADENCE_DEBUG=false in production
# 5. Configure CORS origins properly (never use * in production)
# 6. Set up proper monitoring and alerting
# 7. Operational settings (LLM defaults, pool sizes, rate limits, etc.) are
#    managed via PATCH /api/admin/settings and stored in global_settings DB table.
#    Changes are broadcast to all nodes via RabbitMQ automatically.
